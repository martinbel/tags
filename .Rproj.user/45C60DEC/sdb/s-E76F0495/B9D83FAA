{
    "contents" : "rm(list = ls(all = TRUE)); gc()\npkg = c(\"data.table\", \"plyr\", \"tm\", \"e1071\", \"Matrix\", 'XML')\n\nlibrary(XML2R)\nsapply(pkg, require, c=T)\nsource('funs.R')\n\nwd <- getwd()\ndirectories <- sprintf('%s/stackexchange/%s', wd, list.files(path=paste0(wd, '/stackexchange')))\nxmls <- paste0(directories, '/Posts.xml')\n\n## read xml\nobs <- XML2Obs(xmls[1], local=TRUE)\nobs <- ldply(as.list(obs), 'rbind')\n\n\n\n\n\n\ndoc = xmlTreeParse(files[6], useInternalNodes = TRUE)\n\nlapply(getNodeSet(doc, \"//tags//row[@TagName]\"), xmlValue)\n\ntag_path <- '//*[@id=\"collapsible0\"]/div[1]/div[2]/div[1]/span/span[2]/span[2]'\nsapply(xml[tag_path], xmlValue)\n\nxmlToDataFrame(xml)\n\ntag_name <- xpathApply(xml, '//tags/row/TagName')\n\ntime_path <- \"//start-valid-time\"\ntemp_path <- \"//temperature[@type='hourly']/value\"\n\ndf <- data.frame(\n  latitude=data[[\"number(//point/@latitude)\"]],\n  longitude=data[[\"number(//point/@longitude)\"]],\n  start_valid_time=sapply(data[time_path], xmlValue),\n  hourly_temperature=as.integer(sapply(data[temp_path], as, \"integer\"))\n\n\n\ndata <- unz('7z',filename=zip_files[[1]])\ndata <- read.table(data)\n\ntemp <- tempfile()\ndata <- readLines(unz(temp, \"/Users/mbtangotan/Desktop/dm/free/tags/beer.stackexchange.com.7z\"))\ndata <- read.table(unz(temp, \"a1.dat\"))\nunlink(temp)\n\nsplit_data <- lapply(seq_along(data), function(x){\n  do.call(rbind, strsplit(data[x], '\\t'))\n})\n\nd <- ldply(split_data, 'rbind')\n\n\n\n\n### drop null\nd$q_char <- nchar(as.character(d[,2]))\nd <- d[d$q_char > 0, ]\nd <- d[-which(is.na(d[,2])), ]\n",
    "created" : 1428451732343.000,
    "dirty" : false,
    "encoding" : "LATIN1",
    "folds" : "",
    "hash" : "1037926759",
    "id" : "B9D83FAA",
    "lastKnownWriteTime" : 1428457919,
    "path" : "~/Desktop/dm/free/tags/1_read_zip_files.R",
    "project_path" : "1_read_zip_files.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}